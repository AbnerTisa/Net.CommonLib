/*******************************************************************
 * * 文件名：
 * * 文件作用：
 * *-------------------------------------------------------------------
 * * 修改历史记录：
 * * 修改时间      修改人    修改内容概要
 * * 2013-02-23    xwj       新增
 * *******************************************************************/

using System;
using System.IO;
using System.Text;

namespace Net.CommonLib.ExcelReport.License
{
    public class License
    {
        private static string licenseStr =
            "3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D227574662D38223F3E0D0A3C4C6963656E736520786D6C6E733A7873693D22687474703A2F2F7777772E77332E6F72672F323030312F584D4C536368656D612D696E7374616E63652220786D6C6E733A7873643D22687474703A2F2F7777772E77332E6F72672F323030312F584D4C536368656D6122204B65793D226D5258486F656C516D6F515531737342414B45385568427947677A4B4C32673968696D7A433478632B4F516D4E643731387A6D747030696E4C34726855613839376168344C6377656244305849626677676C795762456A646C627839786E435633662F3079366D584B7944386D59387539382B41327A6F647978494C394767784F537367724C6551723956385259536349324F753174474C3251386B75377635765430556E2B64516632536F587032454D337A326642417958673067414E527247663856554D56614A3666667079626A53384733572B3637357674356C79556C455770753559356861794534302F5967752F5066494453553378546E646E456230764F43696638466D58636E536F735773622B6E53574E4562426849784478594F4944684D4A493354353154372F3645564171494536374B2F4852412B6549446D5331716A6D44382B7537574C6873782F315933526878552F56437A756E39414847563061376D7651516A4C745262556237563232515A6430646D726C796864554E4E4B36774966696A354C45706674477479446E575452416F66376B43416B774431387A5875655362315036547746394F58585662353161307845515957415762476F4E364D6F4373516E706679636F30483648696A50717644785561583732486F396F536C6C36584F562B6F315675543730655277546E4530674D646C353537465142706735517670794A4D545739656350333469786E57494C416A425A636C484B476B7930644B4F72726E714B446E6D56466C724C6263646B4C526E554E3576565A783257684C30436D68692F5051582B6F514B3937637A396377476152494443795945514936347533584C716D4645707377334F77397642623173614F4343784343466B714A6C385076544232545A2B764F764E704B685969724C6968452F42386D58536E574642704D4F77776C494F59674171636A4C6150544E57464E7167703972345A616E32724D76377655524F5168706B416E726735484D3544596A576B7A2F6756494769726550774E72447A3347396D4E6849746533593153505561636F4A31687346453978314D724242362B7A396C745068322F316B4A6F4F6D70716A576D616B5774304877487770546D7767374B3456666D4470644F4E387A37644679552B736A7765434365724931564E594D374D457175414C5A30657676316C746631564B43374B6B4B79366A626B583046543051302B4D6B4C6E6F637668345259704C52737661554F6238654E455A635153746A65514231487A77626C5654366D42726462624654476C764270422F684E686932433573517547477A536A5776634D6C4A78386E67483964314F377A6C73443538314E61335451494A6B626B44762B532F4B6E49417A4347496C346E396A6431776934724B7773493246764C2B64652F784B4C684470507A4A755461566E4A2F354153395852364F5063654463472B452F306E6F643056322F335073567A75426163505448706669673467754C2B646D6F76644449395A5A5077462F5A626964726D35526C6166762F696250796B4F387831786E35305177725A4B4768454A39526978616C4F572B527A373357317A425761585246546E464F2F644C4650686F66614171366D4A58776973786D47475873497342507736444B35684176766232355773784C626D33707741385A5759774B2F75614343453965396C63414575415455663145633277555932464C4E31466A304871787348306D36563068486958666A464A6D3871525863536E336E32627978313271666345313578484B4458613958654F3934377A78656F383571414776754F544F554A6346646A774752375879504B626467466153386B6348754251625A614473497034333746524745414437427A474A74585A76694D34376D4953694855776F595A3341355236566A7454456C7973326B6E34584D705476776959486D5A46436F554D664B48762F586C504A444D7A362B36756458543976584B686B4B2B676843756239552B70553036613552614872325A334537633970374B4B387A7779655658744752357234312B626147434F726B32674676543731365445775555486344496E6A79753775333730536971347067393637637A4E4F30467146773D222056657273696F6E3D22312E33223E0D0A093C547970653E52756E74696D653C2F547970653E0D0A093C557365726E616D653E5A68656E6720486F6E676D696E673C2F557365726E616D653E0D0A093C456D61696C3E7A68656E67686D407063692D73756E74656B746563682E636F6D3C2F456D61696C3E0D0A093C4F7267616E697A6174696F6E3E50434920546563686E6F6C6F676965732026616D703B20536572766963657320436F2E2C204C74643C2F4F7267616E697A6174696F6E3E0D0A093C4C6963656E736564446174653E323031352D31312D30395430303A30303A30305A3C2F4C6963656E736564446174653E0D0A093C45787069726564446174653E323031362D31312D30395430303A30303A30305A3C2F45787069726564446174653E0D0A093C50726F64756374733E0D0A09093C50726F647563743E0D0A0909093C4E616D653E53706972652E584C532050726F2045646974696F6E3C2F4E616D653E0D0A0909093C56657273696F6E3E372E383C2F56657273696F6E3E0D0A0909093C537562736372697074696F6E3E0D0A090909093C4E756D6265724F665065726D6974746564446576656C6F7065723E313C2F4E756D6265724F665065726D6974746564446576656C6F7065723E0D0A090909093C4E756D6265724F665065726D6974746564536974653E323134373438333634373C2F4E756D6265724F665065726D6974746564536974653E0D0A0909093C2F537562736372697074696F6E3E0D0A09093C2F50726F647563743E0D0A093C2F50726F64756374733E0D0A093C4973737565723E0D0A09093C4E616D653E652D696365626C75653C2F4E616D653E0D0A09093C456D61696C3E73616C657340652D696365626C75652E636F6D3C2F456D61696C3E0D0A09093C55726C3E687474703A2F2F7777772E652D696365626C75652E636F6D3C2F55726C3E0D0A093C2F4973737565723E0D0A3C2F4C6963656E73653E";

        public static void SetLicense()
        {
            try
            {
                byte[] bytes = ConvertStringToBytes(licenseStr);
                Stream stream = new MemoryStream(bytes);
                Spire.License.LicenseProvider.SetLicenseFileStream(stream);
            }
            catch (Exception ex)
            {
                Console.WriteLine("SetLicenseError:" + ex.Message);
            }
        }

        /// <summary>
        /// 将16进制字符串转化为字节数组
        /// </summary>
        /// <param name="strHex"></param>
        /// <returns></returns>
        public static byte[] ConvertStringToBytes(string strHex)
        {
            if (strHex == null)
            {
                return null;
            }
            if (strHex.Length < 2)
            {
                return null;
            }
            byte[] bytes = Encoding.ASCII.GetBytes(strHex);
            int num = bytes.GetLength(0) >> 1;
            byte[] buffer2 = new byte[num];
            for (int i = 0; i < (num << 1); i++)
            {
                byte num3 = 0;
                if ((bytes[i] >= 0x30) && (bytes[i] <= 0x39))
                {
                    num3 = (byte)(bytes[i] - 0x30);
                }
                else if ((bytes[i] >= 0x41) && (bytes[i] <= 70))
                {
                    num3 = (byte)((bytes[i] - 0x41) + 10);
                }
                if ((i % 2) == 0)
                {
                    buffer2[i >> 1] = (byte)(num3 << 4);
                }
                else
                {
                    buffer2[i >> 1] = (byte)(buffer2[i >> 1] + num3);
                }
            }

            return buffer2;
        }
    }
}